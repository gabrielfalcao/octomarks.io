{% extends "base.html" %}

{% block body %}
<div class="container">
  {% include "logo.html" %}
  <div class="row-fluid">
    <div class="span5 offset3">
      <h2>Save a bookmark</h2>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span5 offset3">
      <input id="uri" class="classy-input" type="text" name="bookmark_url" placeholder="http://github.com/username/project" />
    </div>
  </div>
  <div class="row-fluid">
    <div class="span8">
      <input type="button" id="main-save" class="btn btn-large btn-warning" name="action" value="save" disabled="true" />
    </div>
  </div>

  {% if user.gb_token %}
  <div class="bookmarklet-container">
    <div class="row-fluid">
      <div class="span5 offset3">
        <h3>or be clever and</h3>
      </div>
    </div>

    <div class="row-fluid">
      <div class="span5 offset3">
        <h4>drag this button to your bookmarks bar:</h4>
        <a class="btn btn-success btn-large" href="javascript: (function () {var GBKLET=document.createElement('script');GBKLET.setAttribute('src', '{{ full_url_for(".serve_bookmarklet", token=user.gb_token) }}?' + (new Date()).getTime());document.body.appendChild(GBKLET);}());">save github favorite</a>
      </div>
    </div>
  </div>
  {% endif %}
</div>

<script type="text/javascript">
(function($){
  $("#main-save").on("click", function(){
    location.href='{{ settings.absurl(url_for(".save_bookmark", token=user.gb_token)) }}?uri=' + encodeURIComponent($("#uri").val());
  });
  $("#uri").on("keyup", function(){
    var text = $(this).val().trim();
    if (text.length > 0) {
      $("#main-save").removeAttr("disabled");
    } else {
      $("#main-save").attr("disabled", "disabled");
    }
  });
})(window.jQuery);
</script>
{% endblock %}
